(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26f2"],{"04a5":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"m-table-comb"},[a("section",{staticClass:"table-filter"},[a("div",{staticClass:"controls"},[e._t("controls")],2),a("el-form",{attrs:{model:e.searchModelDataBase,"label-width":"120px",size:"small"}},[e.isShowBaseSearch?a("el-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入关键字","prefix-icon":"el-icon-search",clearable:""},model:{value:e.searchModelDataBase.name,callback:function(t){e.$set(e.searchModelDataBase,"name",t)},expression:"searchModelDataBase.name"}}):e._e(),e._t("baseSearchForm",null,{form:this.searchModelDataBase}),e.isOpenAdvancedSearch?e._e():a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e.searchModel?a("el-button",{staticStyle:{"margin-left":"10px"},on:{click:function(t){e.openAdvancedSearch()}}},[e._v(e._s(e.isOpenAdvancedSearch?"关闭高级查询":"高级查询"))]):e._e()],2)],1),a("section",{directives:[{name:"show",rawName:"v-show",value:e.isOpenAdvancedSearch,expression:"isOpenAdvancedSearch"}],staticClass:"table-filter-advanced"},[a("el-form",{attrs:{model:e.searchModelData,"label-width":"120px",size:"small"}},[e._t("advancedSearchForm",null,{form:this.searchModelData}),a("div",{staticClass:"form-controls"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.search}},[e._v("查询")]),a("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.isOpenAdvancedSearch=!1}}},[e._v("取消")])],1)],2)],1),a("section",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{select:e.checkedOne,"select-all":e.checkedAll,"sort-change":e.tableSortChange}},[e._t("tableColumns")],2)],1),a("section",{directives:[{name:"show",rawName:"v-show",value:this.checkedItems&&this.checkedItems.length>0,expression:"this.checkedItems && this.checkedItems.length > 0"}]},[a("div",{staticClass:"checked-items"},[a("transition-group",{attrs:{tag:"div",name:"scale",mode:"out-in"}},e._l(this.checkedItems,function(t){return a("span",{key:t.id},[e._v(e._s(t.username||t.name||t.title||t.id)+" "),a("i",{on:{click:function(a){e.removeCheckedItem(t)}}})])})),a("a",{staticClass:"clear-all",attrs:{href:"javascript:void(0);"},on:{click:function(t){e.removeAllCheckedItem()}}},[e._v("清空")])],1)]),a("section",{staticClass:"table-paging"},[a("el-pagination",{attrs:{"current-page":e.pagingInfo.currentPage,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pagingInfo.totalRecord},on:{"size-change":e.handleSizeChange,"current-change":e.fetchData}})],1)])},n=[],i=(a("f751"),a("2ef0")),c={name:"DataTableComb",props:{name:String,getAction:Function,getActionWhere:Object,removeAction:Function,removeBatchAction:Function,editPath:String,listPath:String,searchModel:Object,searchModelBase:{type:Object,default:function(){return{name:""}}},pagingConfig:Object,autoFetch:{type:Boolean,default:!0},sortChange:Function},data:function(){return{loading:!0,tableData:[],checkedItems:[],isOpenAdvancedSearch:!1,sortInfo:null,pagingInfo:{pageSize:10,currentPage:1,totalRecord:0},searchModelDataBase:{},searchModelData:{}}},computed:{isShowBaseSearch:function(){return!this.$scopedSlots.baseSearchForm}},methods:{tableSortChange:function(e){var t=e.column,a=e.prop,s=e.order;this.sortChange?this.sortChange({column:t,prop:a,order:s}):this.sortInfo=t?a+"_"+s.substr(0,3):null,this.fetchData()},checkedOne:function(e,t){var a,s=e.some(function(e){return e.id===t.id});if(s)a=this.checkedItems.some(function(e){return e.id===t.id}),a||this.checkedItems.push(t);else for(var n=0;n<this.checkedItems.length;n++)if(this.checkedItems[n].id===t.id){this.checkedItems.splice(n,1);break}},checkedAll:function(e){var t=this;e.length>0?e.map(function(a){t.checkedOne(e,a)}):this.tableData.map(function(e){t.checkedOne([],e)})},removeCheckedItem:function(e){for(var t=0;t<this.checkedItems.length;t++)if(this.checkedItems[t].id===e.id){this.$refs.table.toggleRowSelection(e,!1);for(var a=0;a<this.tableData.length;a++)if(this.tableData[a].id===e.id){this.$refs.table.toggleRowSelection(this.tableData[a],!1);break}this.checkedItems.splice(t,1);break}},removeAllCheckedItem:function(){for(var e=0;e<this.checkedItems.length;e++){this.$refs.table.toggleRowSelection(this.checkedItems[e],!1);for(var t=0;t<this.tableData.length;t++)if(this.tableData[t].id===this.checkedItems[e].id){this.$refs.table.toggleRowSelection(this.tableData[t],!1);break}this.checkedItems.splice(e,1),e--}},initRecordChecked:function(){for(var e=0;e<this.checkedItems.length;e++)for(var t=0;t<this.tableData.length;t++)if(this.checkedItems[e].id===this.tableData[t].id){this.$refs.table.toggleRowSelection(this.tableData[t],!0);break}},openAdvancedSearch:function(){this.isOpenAdvancedSearch=!this.isOpenAdvancedSearch},edit:function(e){this.editPath?this.$router.push({path:this.editPath+"/"+e}):this.$message.error("编辑失败，因为对应的Action没有设置")},remove:function(e){var t=this;t.removeAction?this.$msgbox({title:"提示",message:"确定要删除该数据？",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){"confirm"===a&&(t.loading=!0,t.removeAction(e).then(function(a){if(0===a.code){for(var s=0;s<t.tableData.length;s++)t.tableData[s].id===e&&(t.tableData.splice(s,1),s++);t.tableData.length>0?t.fetchData():t.fetchData(t.pagingInfo.currentPage-1||1),t.$message.success("删除数据成功"),t.$emit("on-remove-success")}else t.$message.error(a.message);t.loading=!1}).catch(function(){t.$message.error("删除数据失败")}))}).catch(function(){}):t.$message.error("删除失败，因为对应的Action没有设置")},removeBatch:function(){var e=this,t=this.checkedItems.map(function(e){return e.id});this.removeBatchAction?0!==t.length?this.$msgbox({title:"提示",message:"确定要删除选中的数据？",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){"confirm"===a&&(e.loading=!0,e.removeBatchAction(t).then(function(){for(var a=0;a<e.tableData.length;a++)for(var s=0;s<t.length;s++)if(e.tableData[a].id===t[s]){e.tableData.splice(a,1),a--;break}e.checkedItems=[],e.loading=!1,e.$message.success("删除数据成功"),e.$emit("on-remove-success")}).catch(function(){e.$message.error("删除数据失败")}))}).catch(function(){}):e.$message.warning("请选择数据"):this.$message.error("删除失败，因为对应的Action没有设置")},fetchData:function(e){var t=this,a={};if(this.getAction){for(var s in t.pagingInfo.currentPage=e||t.pagingInfo.currentPage||1,t.loading=!0,this.searchModelDataBase)if(this.searchModelDataBase.hasOwnProperty(s)){var n=this.searchModelDataBase[s];void 0!==n&&""!==n&&0!==n.length&&(a[s]=this.searchModelDataBase[s])}if(this.isOpenAdvancedSearch)for(var i in this.searchModelData)if(this.searchModelData.hasOwnProperty(i)){var c=this.searchModelData[i];void 0!==c&&""!==c&&0!==c.length&&(a[i]=this.searchModelData[i])}t.sortInfo&&(a.sort=t.sortInfo),Object.assign(a,this.getActionWhere),this.getAction(a,t.pagingInfo).then(function(e){"development"===t.$env&&console.log("[DEBUG] tableData:"),"development"===t.$env&&console.log(e),t.tableData=e.data.data,t.pagingInfo.totalRecord=e.data.totalRecord||e.data.data.length,t.$nextTick(function(){t.initRecordChecked()}),t.loading=!1}).catch(function(e){console.error(e),t.$message.error("获取数据列表失败"),t.loading=!1})}else this.$message.error("获取数据失败，因为对应的Action没有设置")},reset:function(){this.searchModelData=Object(i["clone"])(this.searchModel)},handleSizeChange:function(e){this.pagingInfo.pageSize=e,this.fetchData()},search:function(){this.fetchData()}},mounted:function(){var e=this;this.autoFetch?e.fetchData():e.loading=!1,this.searchModelData=Object(i["clone"])(this.searchModel),this.searchModelDataBase=Object(i["clone"])(this.searchModelBase),Object.assign(this.pagingInfo,this.pagingConfig)}},o=c,r=(a("79f7"),a("2877")),h=Object(r["a"])(o,s,n,!1,null,"058b848c",null);h.options.__file="index.vue";t["default"]=h.exports},"0eb7":function(e,t,a){},"79f7":function(e,t,a){"use strict";var s=a("0eb7"),n=a.n(s);n.a}}]);
//# sourceMappingURL=chunk-26f2.1b497241.js.map